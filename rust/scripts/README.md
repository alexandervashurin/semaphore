# –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Go –º–æ–¥—É–ª—è–º–∏

## üìã –û–±–∑–æ—Ä

–≠—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ —É–¥–∞–ª–µ–Ω–∏—è Go –º–æ–¥—É–ª–µ–π –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ Rust.

---

## üîß –°–∫—Ä–∏–ø—Ç—ã

### 1. analyze_go_deps.sh

–°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π Go –º–æ–¥—É–ª–µ–π.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```bash
./analyze_go_deps.sh [–º–æ–¥—É–ª—å]
```

**–ü—Ä–∏–º–µ—Ä—ã**:
```bash
# –ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π
./analyze_go_deps.sh all

# –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–æ–¥—É–ª—è
./analyze_go_deps.sh tz
./analyze_go_deps.sh random
./analyze_go_deps.sh conv
./analyze_go_deps.sh common_errors
./analyze_go_deps.sh task_logger
./analyze_go_deps.sh ssh
```

**–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**:
- –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö –º–æ–¥—É–ª—å
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —É–¥–∞–ª–µ–Ω–∏—è

---

### 2. remove_go_module.sh

–°–∫—Ä–∏–ø—Ç –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è Go –º–æ–¥—É–ª–µ–π.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```bash
./remove_go_module.sh <–º–æ–¥—É–ª—å>
```

**–ü—Ä–∏–º–µ—Ä—ã**:
```bash
# –£–¥–∞–ª–µ–Ω–∏–µ –º–æ–¥—É–ª—è tz
./remove_go_module.sh tz

# –£–¥–∞–ª–µ–Ω–∏–µ –º–æ–¥—É–ª—è random
./remove_go_module.sh random
```

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç —É–¥–∞–ª–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –º–æ–¥—É–ª–µ–π

**–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è**:
- ‚ö†Ô∏è –ú–æ–¥—É–ª–∏ `ssh` –∏ `task_logger` –∑–∞—â–∏—â–µ–Ω—ã –æ—Ç —É–¥–∞–ª–µ–Ω–∏—è
- ‚ö†Ô∏è –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
- ‚ö†Ô∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

---

## üìä –ü–æ—Ä—è–¥–æ–∫ —É–¥–∞–ª–µ–Ω–∏—è –º–æ–¥—É–ª–µ–π

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: pkg/tz ‚úÖ

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –º–æ–¥—É–ª—å –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è.

```bash
# 1. –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
./analyze_go_deps.sh tz

# 2. –ó–∞–º–µ–Ω–∞ –∏–º–ø–æ—Ä—Ç–æ–≤ –≤ Go –∫–æ–¥–µ (–≤—Ä—É—á–Ω—É—é –∏–ª–∏ —Å–∫—Ä–∏–ø—Ç–æ–º)
find . -name "*.go" -type f -exec sed -i 's|"github.com/semaphoreui/semaphore/pkg/tz"|time|g' {} \;
find . -name "*.go" -type f -exec sed -i 's|tz\.Now()|time.Now().UTC()|g' {} \;
find . -name "*.go" -type f -exec sed -i 's|tz\.In(\([^)]*\))|\1.UTC()|g' {} \;

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞
go build ./...

# 4. –£–¥–∞–ª–µ–Ω–∏–µ (–µ—Å–ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –Ω–µ—Ç)
./remove_go_module.sh tz
```

---

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: pkg/random

–ü—Ä–æ—Å—Ç–æ–π –º–æ–¥—É–ª—å, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ pkg/ssh.

```bash
# 1. –ê–Ω–∞–ª–∏–∑
./analyze_go_deps.sh random

# 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ pkg/ssh/agent.go (–µ—Å–ª–∏ –µ—â—ë –Ω–µ —É–¥–∞–ª—ë–Ω)
# –ó–∞–º–µ–Ω–∏—Ç—å:
#   import "github.com/semaphoreui/semaphore/pkg/random"
#   random.String(10)
# –ù–∞:
#   import (
#       "crypto/rand"
#       "encoding/hex"
#   )
#   bytes := make([]byte, 10)
#   rand.Read(bytes)
#   str := hex.EncodeToString(bytes)[:10]

# 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞
go build ./...

# 5. –£–¥–∞–ª–µ–Ω–∏–µ
./remove_go_module.sh random
```

---

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: pkg/conv

–¢—Ä–µ–±—É–µ—Ç—Å—è —Å–æ–∑–¥–∞–Ω–∏–µ Rust-–∞–Ω–∞–ª–æ–≥–∞.

```bash
# 1. –°–æ–∑–¥–∞–Ω–∏–µ rust/src/utils/conv.rs
# 2. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π
# 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
# 4. –£–¥–∞–ª–µ–Ω–∏–µ Go –º–æ–¥—É–ª—è
./remove_go_module.sh conv
```

---

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 4: pkg/common_errors

–°—Ä–µ–¥–Ω—è—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å.

```bash
# 1. –ê–Ω–∞–ª–∏–∑
./analyze_go_deps.sh common_errors

# 2. –î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ rust/src/error.rs

# 3. –ó–∞–º–µ–Ω–∞ –≤ Go –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏

# 4. –£–¥–∞–ª–µ–Ω–∏–µ
./remove_go_module.sh common_errors
```

---

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 5: pkg/task_logger ‚ö†Ô∏è

–ö—Ä–∏—Ç–∏—á–Ω—ã–π –º–æ–¥—É–ª—å —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

**–ù–ï –£–î–ê–õ–Ø–¢–¨** –¥–æ –ø–æ–ª–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞ Rust!

```bash
# 1. –ê–Ω–∞–ª–∏–∑ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏)
./analyze_go_deps.sh task_logger

# 2. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Rust:
#    - TaskStatus enum —Å –º–µ—Ç–æ–¥–∞–º–∏
#    - Logger trait
#    - –ë–∞–∑–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–≥–≥–µ—Ä–∞

# 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π

# 4. –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –∑–∞–º–µ–Ω–∞

# 5. –£–¥–∞–ª–µ–Ω–∏–µ (–¢–û–õ–¨–ö–û –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∑–∞–º–µ–Ω—ã)
# ./remove_go_module.sh task_logger
```

---

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 6: pkg/ssh ‚ùå

–û—á–µ–Ω—å –∫—Ä–∏—Ç–∏—á–Ω—ã–π –º–æ–¥—É–ª—å.

**–ù–ï –£–î–ê–õ–Ø–¢–¨** –¥–æ –ø–æ–ª–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ SSH-–∞–≥–µ–Ω—Ç–∞ –Ω–∞ Rust!

```bash
# 1. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Rust:
#    - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ ssh2/russh –≤ Cargo.toml
#    - –°–æ–∑–¥–∞–Ω–∏–µ rust/src/services/ssh_agent.rs
#    - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è SSH-–∞–≥–µ–Ω—Ç–∞

# 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å Git

# 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

# 4. –£–¥–∞–ª–µ–Ω–∏–µ (–°–ê–ú–´–ú –ü–û–°–õ–ï–î–ù–ò–ú)
# ./remove_go_module.sh ssh
```

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç `remove_go_module.sh` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –≤:
```
/tmp/semaphore_backup_YYYYMMDD_HHMMSS/
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –º–æ–¥—É–ª—å:
```bash
cp -r /tmp/semaphore_backup_*/pkg/<–º–æ–¥—É–ª—å> /path/to/semaphore/pkg/
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º

1. ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã
2. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç–µ `go build ./...`
3. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç–µ `go test ./...`
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Git

---

## üìù –ß–µ–∫-–ª–∏—Å—Ç —É–¥–∞–ª–µ–Ω–∏—è –º–æ–¥—É–ª—è

- [ ] –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ `analyze_go_deps.sh`
- [ ] –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∑–∞–º–µ–Ω–µ–Ω—ã –∏–ª–∏ —É–¥–∞–ª–µ–Ω—ã
- [ ] Rust-–∞–Ω–∞–ª–æ–≥ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- [ ] `go build ./...` –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ
- [ ] `go test ./...` –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ
- [ ] –°–æ–∑–¥–∞–Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- [ ] –û–±–Ω–æ–≤–ª—ë–Ω `GO_MODULES_REMOVAL_PLAN.md`
- [ ] –û–±–Ω–æ–≤–ª—ë–Ω `CHANGELOG.md`
- [ ] –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∞—á–µ–Ω—ã

---

## üîç –û—Ç–ª–∞–¥–∫–∞

### –í–∫–ª—é—á–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥

```bash
set -x
./remove_go_module.sh tz
set +x
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è

```bash
# –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫—É —Å rm -rf –≤ —Å–∫—Ä–∏–ø—Ç–µ
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—ã–≤–æ–¥
```

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–∫—Ä–∏–ø—Ç–∞
2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
3. –û—Ç–∫—Ä–æ–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2025-02-25
